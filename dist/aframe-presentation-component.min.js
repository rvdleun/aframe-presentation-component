!function(t){var e={};function i(s){if(e[s])return e[s].exports;var n=e[s]={i:s,l:!1,exports:{}};return t[s].call(n.exports,n,n.exports,i),n.l=!0,n.exports}i.m=t,i.c=e,i.d=function(t,e,s){i.o(t,e)||Object.defineProperty(t,e,{configurable:!1,enumerable:!0,get:s})},i.r=function(t){Object.defineProperty(t,"__esModule",{value:!0})},i.n=function(t){var e=t&&t.__esModule?function(){return t.default}:function(){return t};return i.d(e,"a",e),e},i.o=function(t,e){return Object.prototype.hasOwnProperty.call(t,e)},i.p="",i(i.s=5)}([function(t,e){AFRAME.registerSystem("slide-visibility",{setVisibility:function(t,e){[].slice.call(document.querySelectorAll(t)).forEach(t=>{t.setAttribute("visible",e)})}}),AFRAME.registerComponent("slide-visibility",{schema:{selector:{type:"string"},visibility:{type:"boolean"}},init:function(){const{selector:t,visibility:e}=this.data;this.el.addEventListener("a-presentation.slide-active",()=>{this.system.setVisibility(t,e)}),this.el.addEventListener("a-presentation.slide-inactive",i=>{const{direction:s}=i.detail;s>=0||this.system.setVisibility(t,!e)})}}),AFRAME.registerPrimitive("a-slide-visibility",{defaultComponents:{"slide-visibility":{}},mappings:{selector:"slide-visibility.selector",visibility:"slide-visibility.visibility"}})},function(t,e){AFRAME.registerSystem("slide-camera",{camera:null,cameraSlides:null,init:function(){this.setCamera("[camera]")},getAllCameraSlides:function(){this.cameraSlides=Array.from(document.querySelectorAll("[slide-camera]"))},setCamera:function(t){this.camera=document.querySelector(t)},moveCamera:function(t,e,i){const{camera:s}=this,{direction:n,instant:a}=t.detail;if(null===this.cameraSlides&&this.getAllCameraSlides(),a)s.setAttribute("position",e.getAttribute("position")),s.setAttribute("rotation",e.getAttribute("rotation"));else if(this.cameraSlides.length>=1){const t=e.getAttribute("position"),a=e.getAttribute("rotation"),o=this.cameraSlides.indexOf(e)+-1*n,r=this.cameraSlides[o],l=r.getAttribute("position"),d=r.getAttribute("rotation"),{duration:c}=n>0?i:r.components["slide-camera"].data;s.setAttribute("animation__position",`property: position; dur: ${c}; easing: linear; from: ${l.x} ${l.y} ${l.z}; to: ${t.x} ${t.y} ${t.z}`),s.setAttribute("animation__rotation",`property: rotation; dur: ${c}; easing: linear; from: ${d.x} ${d.y} ${d.z}; to: ${a.x} ${a.y} ${a.z}`)}}}),AFRAME.registerComponent("slide-camera",{schema:{duration:{type:"number",default:1e3}},init:function(){this.el.addEventListener("a-presentation.slide-active",t=>{t.detail.direction<0||this.system.moveCamera(t,this.el,this.data)}),this.el.addEventListener("a-presentation.slide-inactive",t=>{if(t.detail.instant||t.detail.direction>=0)return;const e=this.system.cameraSlides.indexOf(this.el),i=this.system.cameraSlides[e-1];i&&i!==t.detail.currentSlide&&this.system.moveCamera(t,i,this.data)})}}),AFRAME.registerPrimitive("a-slide-camera",{defaultComponents:{"slide-camera":{}},mappings:{duration:"slide-camera.duration"}})},function(t,e){AFRAME.registerSystem("slide-animation",{timeouts:[],init:function(){setTimeout(()=>{const t=document.querySelector("[presentation]");t&&(console.log(t),t.addEventListener("a-presentation.slide-change",()=>{for(console.log("Clearing up",this.timeouts);this.timeouts.length>0;){const t=this.timeouts.pop();clearTimeout(t)}console.log("Done Clearing up",this.timeouts)}))})},playAnimation:function(t,e,i){if(!t||0===e.length)return;[].slice.call(document.querySelectorAll(t)).forEach(s=>{e.forEach(n=>{const a=s.components[`animation__${n}`];if(a)switch(i){case"from":case"to":a.pauseAnimation();const o=a.data.property,r=a.data[i];s.setAttribute(o,r);break;case"prev":s.setAttribute(`animation__${n}`,"dir","reverse"),a.beginAnimation();break;case"play":s.setAttribute(`animation__${n}`,"dir",""),a.data.delay?(this.playAnimation(t,e,"from"),this.timeouts.push(setTimeout(()=>a.beginAnimation(),a.data.delay))):a.beginAnimation()}})})}}),AFRAME.registerComponent("slide-animation",{schema:{animations:{type:"array"},selector:{type:"string"}},init:function(){this.el.addEventListener("a-presentation.slide-active",t=>{const{direction:e,instant:i}=t.detail,{animations:s,selector:n}=this.data;i?this.system.playAnimation(n,s,"to"):e>0&&this.system.playAnimation(n,s,"play")}),this.el.addEventListener("a-presentation.slide-inactive",t=>{const{direction:e}=t.detail,{animations:i,selector:s}=this.data;this.system.playAnimation(s,i,e<0?"from":"to")})}}),AFRAME.registerPrimitive("a-slide-animation",{defaultComponents:{"slide-animation":{}},mappings:{animations:"slide-animation.animations",selector:"slide-animation.selector"}})},function(t,e){AFRAME.registerComponent("slide",{schema:{},init:function(){this.el.addEventListener("a-presentation.slide-active",this.passEventToChildren.bind(this)),this.el.addEventListener("a-presentation.slide-inactive",this.passEventToChildren.bind(this))},passEventToChildren:function(t){Array.from(this.el.children).forEach(e=>{e.dispatchEvent(new CustomEvent(t.type,t))})}}),AFRAME.registerPrimitive("a-slide",{defaultComponents:{slide:{}},mappings:{}})},function(t,e){AFRAME.registerComponent("presentation",{schema:{progressBar:{type:"boolean",default:!0},shortcuts:{type:"boolean",default:!0},useHash:{type:"boolean",default:!0}},currentSlide:0,progressBar:null,slides:[],swipeSession:{start:null,direction:null},init:function(){if(this.slides=this.el.querySelectorAll("[slide]"),this.data.progressBar){const t=document.createElement("div");t.setAttribute("id","aframe-presentation-progress-bar"),t.style.position="fixed",t.style.bottom="0",t.style.left="0",t.style.height="5px",t.style.width="0",t.style.backgroundColor="white",t.style.transition=".5s width",document.body.append(t),this.progressBar=t}this.data.shortcuts&&(document.addEventListener("keyup",t=>this._onKey(t)),document.addEventListener("touchstart",this.handleTouchStart.bind(this),!1),document.addEventListener("touchmove",this.handleTouchMove.bind(this),!1),document.addEventListener("touchend",this.handleTouchEnd.bind(this),!1)),setTimeout(()=>{const t=this.data.useHash&&window.location.hash?window.location.hash.substring(1):0;this.changeSlide(0,!0);for(let e=0;e<t;e++)this.changeSlide(1,!0)})},handleTouchStart(t){this.swipeSession.start=t.touches[0].clientX},handleTouchMove(t){if(null===this.swipeSession.start)return;const e=t.touches[0].clientX,i=this.swipeSession.start-e;this.swipeSession.direction=i>0?"left":"right"},handleTouchEnd(){switch(this.swipeSession.direction){case"left":this.nextSlide();break;case"right":this.previousSlide()}this.swipeSession.start=null,this.swipeSession.direction=null},changeSlide:function(t,e){const i=this.slides[this.currentSlide];this.currentSlide=Math.max(0,Math.min(this.slides.length-1,this.currentSlide+t));const s=this.slides[this.currentSlide];if(i===s&&!e)return;this.data.progressBar&&(this.progressBar.style.width=`${(this.currentSlide+1)/this.slides.length*100}vw`),this.data.useHash&&(window.location.hash=this.currentSlide.toString());const n={currentSlide:s,direction:t,instant:e,previousSlide:i};this.el.dispatchEvent(new CustomEvent("a-presentation.slide-change",{detail:n})),i.dispatchEvent(new CustomEvent("a-presentation.slide-inactive",{detail:n})),s.dispatchEvent(new CustomEvent("a-presentation.slide-active",{detail:n}))},previousSlide:function(){0!==this.currentSlide&&this.changeSlide(-1)},nextSlide:function(){this.currentSlide!==this.slides.length-1&&this.changeSlide(1)},_onKey:function(t){switch(t.code){case"ArrowLeft":this.previousSlide();break;case"ArrowRight":this.nextSlide()}}}),AFRAME.registerPrimitive("a-presentation",{defaultComponents:{presentation:{}},mappings:{"progress-bar":"presentation.progressBar",shortcuts:"presentation.shortcuts","use-hash":"presentation.useHash"}})},function(t,e,i){i(4),i(3),i(2),i(1),i(0)}]);